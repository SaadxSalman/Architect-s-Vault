<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Micro-Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-10">
    <div class="max-w-2xl mx-auto bg-white p-8 rounded-lg shadow-md">
        <h1 class="text-3xl font-bold mb-6 text-blue-600">Microservices E-Commerce</h1>
        
        <div id="auth-section" class="mb-8">
            <button onclick="login()" class="bg-blue-500 text-white px-4 py-2 rounded">Login as Saad</button>
            <p id="token-status" class="mt-2 text-sm text-gray-500"></p>
        </div>

        <div class="border-t pt-6">
            <h2 class="text-xl font-semibold mb-4">Available Products</h2>
            <div id="product-list" class="space-y-2"></div>
        </div>
    </div>

    <script>
        async function login() {
            const res = await fetch('http://localhost:3000/auth', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: 'saad@example.com' })
            });
            const data = await res.json();
            localStorage.setItem('token', data.token);
            document.getElementById('token-status').innerText = "Logged in! Token saved.";
            loadProducts();
        }

        async function loadProducts() {
            const res = await fetch('http://localhost:3000/store/products');
            const products = await res.json();
            const list = document.getElementById('product-list');
            list.innerHTML = products.map(p => `
                <div class="p-3 bg-gray-50 border rounded flex justify-between">
                    <span>${p.name} - $${p.price}</span>
                    <button class="text-blue-500 font-bold">Buy</button>
                </div>
            `).join('');
        }
    </script>
</body>
</html>